function getISO8601String(n){function r(n){return(n<10?"0":"")+n}var i=n.toISOString(),u=i.substring(0,i.length-1),t=(new Date).getTimezoneOffset(),f=t<0?"+":"-";return t=Math.abs(t),u+f+r(t/60|0)+r(t%60)}var __extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},Telemetry;(function(n){var t;(function(n){var t;(function(n){(function(n){n[n.FeatureUsageEvent=0]="FeatureUsageEvent";n[n.BusinessProcessEvent=1]="BusinessProcessEvent";n[n.BusinessEventMessageExchange=2]="BusinessEventMessageExchange";n[n.BusinessEventEntityUpdate=3]="BusinessEventEntityUpdate";n[n.BusinessEventDatabaseRecord=4]="BusinessEventDatabaseRecord";n[n.SystemEvent=5]="SystemEvent";n[n.Other=6]="Other"})(n.ItEventType||(n.ItEventType={}));var t=n.ItEventType})(t=n.AI||(n.AI={}))})(t=n.Extensions||(n.Extensions={}))})(Telemetry||(Telemetry={})),function(n){var t;(function(n){var t;(function(n){(function(n){n[n.Web=0]="Web";n[n.SmartApp=1]="SmartApp";n[n.Device=2]="Device";n[n.BackgroundProcess=3]="BackgroundProcess";n[n.WebService=4]="WebService";n[n.Executable=5]="Executable";n[n.DynamicLinkLibrary=6]="DynamicLinkLibrary";n[n.JobService=7]="JobService";n[n.WorkflowComponent=8]="WorkflowComponent";n[n.DataStore=9]="DataStore";n[n.Other=10]="Other"})(n.ComponentType||(n.ComponentType={}));var t=n.ComponentType})(t=n.AI||(n.AI={}))})(t=n.Extensions||(n.Extensions={}))}(Telemetry||(Telemetry={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(){function n(){}return n}();n.BaseEvent=t})(t=n.AI||(n.AI={}))})(t=n.Extensions||(n.Extensions={}))}(Telemetry||(Telemetry={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(){function n(n,t,i){this.businessProcessName=n;this.partBValidation=t;this.properties=i}return Object.defineProperty(n.prototype,"BusinessProcessName",{get:function(){return this.businessProcessName},set:function(n){this.businessProcessName=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"PartBValidation",{get:function(){return this.partBValidation},set:function(n){this.PartBValidation=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Properties",{get:function(){return this.properties},set:function(n){this.properties=n},enumerable:!0,configurable:!0}),n}();n.BpmValidation=t})(t=n.AI||(n.AI={}))})(t=n.Extensions||(n.Extensions={}))}(Telemetry||(Telemetry={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(){function n(){}return n.CorrelationHeaaderName="X-CorrelationId",n.CorrelationSchemaAttribute="XCV",n.SubCorrelationHeaderName="Sub-CorrelationId",n.SubCorrelationSchemaAttribute="SubXCV",n}();n.CorrelationConstants=t})(t=n.AI||(n.AI={}))})(t=n.Extensions||(n.Extensions={}))}(Telemetry||(Telemetry={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(){function n(n,t,i,r,u,f,e){this.EnvironmetName=n;this.ServiceOffering=t;this.ServiceLine=i;this.Service=r;this.ComponentName=u;this.ComponentId=f;this.IctoId=e}return n}();n.EnvironmentValues=t})(t=n.AI||(n.AI={}))})(t=n.Extensions||(n.Extensions={}))}(Telemetry||(Telemetry={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(){function n(){}return Object.defineProperty(n.prototype,"getBpmValidations",{get:function(){return this.bpmValidations},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"getEnableBpmValidation",{get:function(){return this.EnableBpmValidation},enumerable:!0,configurable:!0}),n.prototype.ReadBpmValidation=function(n){var i,t;if(n!=null&&typeof n!="undefined"&&this.BpmValidations!=null&&this.BpmValidations.length>0)for(i=this.BpmValidations,t=0;t<i.length;t++)if(i[t].BusinessProcessName==n)return i[t];return null},n}();n.ExtensionsConfig=t})(t=n.AI||(n.AI={}))})(t=n.Extensions||(n.Extensions={}))}(Telemetry||(Telemetry={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(){function n(n,t,i,r){this.EventName=n;this.ComponentType=t;this.startDateTime=i;this.endDateTime=r}return Object.defineProperty(n.prototype,"EventName",{get:function(){return this.eventName},set:function(n){this.eventName=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Duration",{get:function(){return this.duration},set:function(n){this.duration=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ComponentUri",{get:function(){return this.componentUri},set:function(n){this.componentUri=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"EventType",{get:function(){return this.eventType},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"TemplateType",{get:function(){return"Internal.FeatureUsageEvent"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ComponentType",{get:function(){return this.componentType},set:function(n){this.componentType=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Xcv",{get:function(){return this.xcv},set:function(n){this.xcv=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"UserRoleName",{get:function(){return this.userRoleName},set:function(n){this.userRoleName=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"StartDateTime",{get:function(){return this.startDateTime},set:function(n){this.startDateTime=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"EndDateTime",{get:function(){return this.endDateTime},set:function(n){this.endDateTime=n},enumerable:!0,configurable:!0}),n.prototype.IsValidEvent=function(){return this.eventName&&0!==this.eventName.length?!0:!1},n}();n.FeatureUsageEvent=t})(t=n.AI||(n.AI={}))})(t=n.Extensions||(n.Extensions={}))}(Telemetry||(Telemetry={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(){function n(n,t,i,r,u){this.BusinessProcessName=n;this.eventName=n;this.ComponentType=t;this.startDateTime=i;this.endDateTime=r;this.templateType=typeof this.templateType!="undefined"?u:"Internal.BusinessProcessEvent"}return Object.defineProperty(n.prototype,"BusinessProcessName",{get:function(){return this.businessProcessName},set:function(n){this.businessProcessName=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"TargetEntityKey",{get:function(){return this.targetEntityKey},set:function(n){this.targetEntityKey=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ActionUri",{get:function(){return this.actionUri},set:function(n){this.actionUri=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"AppAction",{get:function(){return this.appAction},set:function(n){this.appAction=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"EventType",{get:function(){return this.eventType},set:function(n){this.eventType=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"TemplateType",{get:function(){return"Internal.BusinessProcessEvent"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ComponentType",{get:function(){return this.componentType},set:function(n){this.componentType=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Xcv",{get:function(){return this.xcv},set:function(n){this.xcv=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"UserRoleName",{get:function(){return this.userRoleName},set:function(n){this.userRoleName=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"StartDateTime",{get:function(){return this.startDateTime},set:function(n){this.startDateTime=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"EndDateTime",{get:function(){return this.endDateTime},set:function(n){this.endDateTime=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"EventName",{get:function(){return this.eventName},set:function(n){this.eventName=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"SenderId",{get:function(){return this.senderId},set:function(n){this.senderId=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ReceiverId",{get:function(){return this.receiverId},set:function(n){this.receiverId=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"MessageId",{get:function(){return this.messageId},set:function(n){this.messageId=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"EventOccurrenceTime",{get:function(){return this.eventOccurenceTime},set:function(n){this.eventOccurenceTime=n},enumerable:!0,configurable:!0}),n.prototype.IsValidEvent=function(n){return n?typeof this.appAction!="undefined"&&0!==this.appAction.length&&typeof this.businessProcessName!="undefined"&&0!==this.businessProcessName.length&&typeof this.receiverId!="undefined"&&0!==this.receiverId.length&&typeof this.senderId!="undefined"&&0!==this.senderId.length&&typeof this.eventOccurenceTime!="undefined":this.businessProcessName&&0!==this.businessProcessName.length?!0:!1},n}();n.BusinessProcessEvent=t})(t=n.AI||(n.AI={}))})(t=n.Extensions||(n.Extensions={}))}(Telemetry||(Telemetry={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(){function n(){}return n.toInstance=function(n,t){var i=JSON.parse(t),r;if(typeof n.fromJSON=="function")n.fromJSON(i);else for(r in i)n[r]=i[r];return n},n}(),i;n.SerializationHelper=t;i=function(i){function r(){i.apply(this,arguments)}return __extends(r,i),r.prototype.IsJsonString=function(n){try{JSON.parse(n)}catch(t){return!1}return!0},r.prototype.Initialize=function(i){this.active=t.toInstance(new n.ExtensionsConfig,i)},Object.defineProperty(r.prototype,"getActive",{get:function(){return this.active},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"getBpmValidations",{get:function(){return this.getActive.BpmValidations},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"getEnableBpmValidation",{get:function(){return this.getActive.EnableBpmValidation},enumerable:!0,configurable:!0}),r.prototype.ReadBpmValidation=function(n){var i,t;if(n!=null&&typeof n!="undefined"&&this.getBpmValidations!=null&&this.getBpmValidations.length>0)for(i=this.getBpmValidations,t=0;t<i.length;t++)if(i[t].BusinessProcessName==n)return i[t];return null},r}(t);n.ItTelemetryConfiguration=i})(t=n.AI||(n.AI={}))})(t=n.Extensions||(n.Extensions={}))}(Telemetry||(Telemetry={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(t){function i(i,r,u){t.call(this,i,r,null,null);this.systemMessage=u;this.EventType=n.ItEventType.SystemEvent}return __extends(i,t),Object.defineProperty(i.prototype,"SystemMessage",{get:function(){return this.systemMessage},set:function(n){this.systemMessage=n},enumerable:!0,configurable:!0}),i.prototype.IsValidEvent=function(){return this.EventName&&0!==this.EventName.length?!0:!1},i}(n.BusinessProcessEvent);n.SystemEvent=t})(t=n.AI||(n.AI={}))})(t=n.Extensions||(n.Extensions={}))}(Telemetry||(Telemetry={})),function(n){var t;(function(n){var t;(function(n){"use strict";n.ExtensionVersion="javascript:2.4.7-Build0423";var t=function(){function t(){}return t.prototype.TrackFeatureUsageEvent=function(n,t,i,r){if(typeof window!="undefined"&&typeof JSON!="undefined"&&n!=null&&t!=null){var u=this.isValidEvent(t,i);if(u)i=this.BuildFeatureEventProperties(t,i),n.trackEvent(t.EventName,i,r);else throw"One or more attributes in the in the event Feature Usage Event are not valid";}},t.prototype.TrackBusinessProcessEvent=function(n,t,i,r){if(typeof n!="undefined"&&typeof JSON!="undefined"&&n!=null&&t!=null){var u=this.isValidEvent(t,i);if(u)i=this.BuildBusinessEventProperties(t,i),n.trackEvent(t.BusinessProcessName,i,r);else throw"One or more attributes in the event Business Process Event are not valid";}},t.prototype.TrackSystemEvent=function(n,t,i,r){if(typeof n!="undefined"&&typeof JSON!="undefined"&&n!=null&&t!=null){var u=this.isValidEvent(t,i);if(u)i=this.BuildSystemEventProperties(t,i),n.trackEvent(t.BusinessProcessName,i,r);else throw"One or more attributes in the event System Event are not valid";}},t.prototype.AddMsitTelemetryInitializers=function(t,i,r){var u=this;t.context.addTelemetryInitializer(function(f){var e,o;u.correlationProvider=r;e=f.data.baseData;e.properties=e.properties||{};e.properties.AiAppKey=t.config.instrumentationKey;i!=null&&(e.properties.EnvironmentName=i.EnvironmetName==null?"":i.EnvironmetName,e.properties.ServiceOffering=i.ServiceOffering==null?"":i.ServiceOffering,e.properties.ServiceLine=i.ServiceLine==null?"":i.ServiceLine,e.properties.Service=i.Service==null?"":i.Service,e.properties.ComponentName=i.ComponentName==null?"":i.ComponentName,e.properties.ComponentId=i.ComponentId==null?"":i.ComponentId,i.IctoId!=null&&i.IctoId!==""&&(e.properties.IctoId=i.IctoId),e.properties.ItExtVersion=n.ExtensionVersion);o="";u.correlationProvider!=null&&(o=r());o!=null&&o!==""&&(e.properties.XCV=o)})},t.prototype.AddMsitTelemetryInitializerswithSubCorrelation=function(t,i,r,u){var f=this;t.context.addTelemetryInitializer(function(e){var o,s,h;f.correlationProvider=r;o=e.data.baseData;o.properties=o.properties||{};o.properties.AiAppKey=t.config.instrumentationKey;i!=null&&(o.properties.EnvironmentName=i.EnvironmetName==null?"":i.EnvironmetName,o.properties.ServiceOffering=i.ServiceOffering==null?"":i.ServiceOffering,o.properties.ServiceLine=i.ServiceLine==null?"":i.ServiceLine,o.properties.Service=i.Service==null?"":i.Service,o.properties.ComponentName=i.ComponentName==null?"":i.ComponentName,o.properties.ComponentId=i.ComponentId==null?"":i.ComponentId,o.properties.ItExtVersion=n.ExtensionVersion);s="";f.correlationProvider!=null&&(s=r());s!=null&&s!==""&&(o.properties.XCV=s);h="";f.subCorrelationProvider!=null&&(s=u());h!=null&&h!==""&&(o.properties.SubXCV=h)})},t.prototype.BuildFeatureEventProperties=function(t,i){var r;return r=i||{},r.ComponentUri=t.ComponentUri===undefined?"":t.ComponentUri,r["Duration "]=t.Duration===undefined?null:t.Duration,r.ComponentType=t.ComponentType!==undefined&&t.ComponentType!=null?n.ComponentType[t.ComponentType].toString():"",r.UserRoleName=t.UserRoleName===undefined?"":t.UserRoleName,r.XCV=t.Xcv===undefined?"":t.Xcv,r.EventType=t.EventType!==undefined&&t.EventType!=null?n.ItEventType[t.EventType].toString():"",r.StartDateTime=t.StartDateTime===undefined||t.StartDateTime===null?"":t.StartDateTime.toUTCString(),r.EndDateTime=t.EndDateTime===undefined||t.EndDateTime===null?"":t.EndDateTime.toUTCString(),r.TemplateType=t.TemplateType===undefined||t.TemplateType===null?"":t.TemplateType,r.MsitPartB="true",r},t.prototype.BuildBusinessEventProperties=function(t,i){var r;return r=i||{},r.ActionUri=t.ActionUri===undefined?"":t.ActionUri,r.AppAction=t.AppAction===undefined?"":t.AppAction,r.ComponentType=t.ComponentType!==undefined&&t.ComponentType!=null?n.ComponentType[t.ComponentType].toString():"",r.TargetEntityKey=t.TargetEntityKey===undefined?"":t.TargetEntityKey,r.UserRoleName=t.UserRoleName===undefined?"":t.UserRoleName,r.XCV=t.Xcv===undefined?"":t.Xcv,r.EventType=t.EventType!==undefined&&t.EventType!=null?n.ItEventType[t.EventType].toString():"",r.StartDateTime=t.StartDateTime===undefined||t.StartDateTime===null?"":t.StartDateTime.toUTCString(),r.EndDateTime=t.EndDateTime===undefined||t.EndDateTime===null?"":t.EndDateTime.toUTCString(),r.SenderId=t.SenderId===undefined?"":t.SenderId,r.ReceiverID=t.ReceiverId===undefined?"":t.ReceiverId,r.MessageId=t.MessageId===undefined?"":t.MessageId,r.EventOccurrenceTime=t.EventOccurrenceTime===undefined||t.EventOccurrenceTime===null||isNaN(t.EventOccurrenceTime.getDate())?"":getISO8601String(new Date(t.EventOccurrenceTime.toString())),r.BusinessProcessName=t.BusinessProcessName===undefined?"":t.BusinessProcessName,r.TemplateType=t.TemplateType===undefined||t.TemplateType===null?"":t.TemplateType,r.MsitPartB="true",r},t.prototype.BuildSystemEventProperties=function(t,i){var r;return r=i||{},r.ActionUri=t.ActionUri===undefined?"":t.ActionUri,r.AppAction=t.AppAction===undefined?"":t.AppAction,r.ComponentType=t.ComponentType!==undefined&&t.ComponentType!=null?n.ComponentType[t.ComponentType].toString():"",r.TargetEntityKey=t.TargetEntityKey===undefined?"":t.TargetEntityKey,r.UserRoleName=t.UserRoleName===undefined?"":t.UserRoleName,r.XCV=t.Xcv===undefined?"":t.Xcv,r.EventType=t.EventType!==undefined&&t.EventType!=null?n.ItEventType[t.EventType].toString():"",r.StartDateTime=t.StartDateTime===undefined||t.StartDateTime===null?"":t.StartDateTime.toUTCString(),r.EndDateTime=t.EndDateTime===undefined||t.EndDateTime===null?"":t.EndDateTime.toUTCString(),r.SenderId=t.SenderId===undefined?"":t.SenderId,r.ReceiverID=t.ReceiverId===undefined?"":t.ReceiverId,r.MessageId=t.MessageId===undefined?"":t.MessageId,r.EventOccurrenceTime=t.EventOccurrenceTime===undefined||t.EventOccurrenceTime===null||isNaN(t.EventOccurrenceTime.getDate())?"":getISO8601String(new Date(t.EventOccurrenceTime.toString())),r.BusinessProcessName=t.BusinessProcessName===undefined?"":t.BusinessProcessName,r.SystemMessage=t.SystemMessage===undefined||t.SystemMessage===null?"":t.SystemMessage,r.TemplateType=t.TemplateType===undefined||t.TemplateType===null?"":t.TemplateType,r.MsitPartB="true",r},t.prototype.isValidEvent=function(n,t){var u=this.ItTelemetryConfig,r=n.IsValidEvent(!1),i,f,o,h;if(u!==null&&u!==undefined&&u.active.EnableBpmValidation){if(i=u.active.ReadBpmValidation(n.EventName),i==null)return r;if(i.PartBValidation&&(r=n.IsValidEvent(i.PartBValidation)),i.Properties!=null){var c=Object.keys(t),e=i.Properties,s=0;for(f=0;f<e.length;f++)if(o=e[f],h=c.indexOf(o),h>=0)if(typeof t[o]!="undefined")s+=1;else{r=!1;break}return s==e.length&&r!=!1?!0:!1}}else return r},t}();n.AppInsights=t})(t=n.AI||(n.AI={}))})(t=n.Extensions||(n.Extensions={}))}(Telemetry||(Telemetry={}))